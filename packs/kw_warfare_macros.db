{"name":"K&W Command","type":"script","img":"icons/skills/melee/sword-shield-stylized-white.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\nkwToken.actor.rollKWUnitAttribute('command');","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.xkDicYkkc7hxqDEU"}},"_id":"JcrtxXQoSLHCxRJo"}
{"name":"K&W Power","type":"script","img":"icons/skills/melee/unarmed-punch-fist.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\nkwToken.actor.rollKWUnitAttribute('power');","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.qTm1ShJM8mz7y5AY"}},"_id":"KZ5tSrJB8JeDrB7U"}
{"name":"K&W Morale","type":"script","img":"icons/skills/social/intimidation-impressing.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\nkwToken.actor.rollKWUnitAttribute('morale');","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.sqTIy5sjtBfNMN70"}},"_id":"LZTA4SOFuSL2KTUW"}
{"name":"K&W Apply 1 Damage To Target","type":"script","img":"icons/skills/melee/blood-slash-foam-red.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\n\nif(game.user.targets.size > 1) {\n   ui.notifications.error(\"Too many targets selected.\");\n   return;\n} else if (game.user.targets.size == 0) {\n   ui.notifications.error(\"Requires 1 target selected.\");\n   return;\n}\n\nconst targetToken = game.user.targets.values().next().value;\nif(targetToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Target not a Warfare Unit\");\n  return;\n}\n\nif(targetToken.id == kwToken.id) {\n  ui.notifications.error(\"Cannot target self.\");\n  return;\n}\n\nconst target = targetToken.actor;\n\nconst damage = 1;\n\nnew Roll(`${damage}`).roll().toMessage({\n    speaker: ChatMessage.getSpeaker(),\n    flavor: `${actor .name} hits ${target.name} for ${damage} damage.`})\ntarget.update({\"data.attributes.hp.value\" : target.data.data.attributes.hp.value - damage});","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.fSnxyLUn210ky6nP"}},"_id":"Mann4Bjo4o6E48Y7"}
{"name":"K&W Apply Unit's Damage To Target","type":"script","img":"icons/skills/melee/blade-tips-triple-bent-white.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\n\nif(game.user.targets.size > 1) {\n   ui.notifications.error(\"Too many targets selected.\");\n   return;\n} else if (game.user.targets.size == 0) {\n   ui.notifications.error(\"Requires 1 target selected.\");\n   return;\n}\n\nconst targetToken = game.user.targets.values().next().value;\nif(targetToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Target not a Warfare Unit\");\n  return;\n}\n\nif(targetToken.id == kwToken.id) {\n  ui.notifications.error(\"Cannot target self.\");\n  return;\n}\n\nconst kwActor = kwToken.actor;\nconst target = targetToken.actor;\n\nconst damage = kwActor.getFlag('kw-warfare', 'stats.damage');\n\nnew Roll(`${damage}`).roll().toMessage({\n    speaker: ChatMessage.getSpeaker(),\n    flavor: `${kwActor.name} hits ${target.name} for ${damage} damage.`})\ntarget.update({\"data.attributes.hp.value\" : target.data.data.attributes.hp.value - damage});","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.abiRMFK1PAmMdZ8K"}},"_id":"neemjMZpQIvu6vJL"}
{"name":"K&W Attack","type":"script","img":"icons/weapons/swords/scimitar-guard-brown.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\nkwToken.actor.rollKWUnitAttribute('attack');","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.8khgYQhHYRAgSbTC"}},"_id":"qSe8ms3eK7J1ScBB"}
{"name":"K&W Set Temp HP","type":"script","img":"icons/magic/life/cross-beam-green.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\n\n(async () => {\n    new Dialog({\n        title: \"K&W Set Unit Temp HP\",\n        content: '<div>Temp HP: <input type=\"number\" name=\"tempHp\" min=\"0\" required style=\"width:24px;\"/></div>',\n        buttons: {\n            setTempHp: {\n                label: \"Set\",\n                callback: (html) => {\n                    const tempHp = html[0].querySelector('input[type=number]').valueAsNumber;\n                    kwToken.actor.update({\"data.attributes.hp.temp\": tempHp});\n                }\n            }\n        },\n        default: \"done\"    \n    }).render(true)\n\n})();","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.7iphhjGmyVBxyFG4"}},"_id":"THt2FhMrcvJiW9f9"}
{"name":"K&W Set Stat Bonus","type":"script","img":"icons/skills/trades/academics-astronomy-navigation-purple.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\n\nconst html = '<div><div>Stat: <select id=\"stat\" name=\"stat\">' +\n            '<option value=\"attack\">Attack</option>' +\n            '<option value=\"defense\">Defense</option>' +\n            '<option value=\"power\">Power</option>' +\n            '<option value=\"toughness\">Toughness</option>' +\n            '<option value=\"morale\">Morale</option>' +\n            '<option value=\"command\">Command</option>' +\n        '</select></div>' +\n'<div>Bonus: <input type=\"number\" name=\"bonus\" min=\"1\" required style=\"width:24px;\"/></div></div>';\n\n(async () => {\n    new Dialog({\n        title: \"K&W Set Stat Bonus\",\n        content: html,\n        buttons: {\n            setStat: {\n                label: \"Set\",\n                callback: (html) => {\n                    const stat = html[0].querySelector('#stat').value;\n                    const bonus = html[0].querySelector('input[type=number]').valueAsNumber;\n                    kwToken.actor.setFlag('kw-warfare', 'bonus.'+stat, bonus);\n                }\n            }\n        },\n        default: \"setStat\"    \n    }).render(true)\n\n})();","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.9iPMsPUp6A28GEay"}},"_id":"30w2BxVKyVGNyvSL"}
{"name":"K&W Set Stat Advantage","type":"script","img":"icons/skills/trades/academics-astronomy-navigation-blue.webp","scope":"global","command":"let kwToken = token;\nif(!kwToken) {\n    if(canvas.tokens.controlled.length > 1) {\n       ui.notifications.error(\"Too many tokens selected.\");\n       return;\n    } else if (canvas.tokens.controlled.length == 0) {\n       ui.notifications.error(\"Requires 1 token selected.\");\n       return;\n    }\n    kwToken = canvas.tokens.controlled[0];\n}\n\nif(kwToken.actor.sheet.constructor.name !== 'KW_WarfareUnitSheet') {\n  ui.notifications.error(\"Token not a Warfare Unit\");\n  return;\n}\n\nconst html = '<div><div>Stat: <select id=\"stat\" name=\"stat\">' +\n            '<option value=\"attack\">Attack</option>' +\n            '<option value=\"power\">Power</option>' +\n            '<option value=\"morale\">Morale</option>' +\n            '<option value=\"command\">Command</option>' +\n        '</select></div>' +\n'<div>Advantage: <input type=\"checkbox\" name=\"advantage\"/></div></div>';\n\n(async () => {\n    new Dialog({\n        title: \"K&W Set Stat Advantage\",\n        content: html,\n        buttons: {\n            setAdvantage: {\n                label: \"Set\",\n                callback: (html) => {\n                    const stat = html[0].querySelector('#stat').value;\n                    const advantage = html[0].querySelector('input[type=checkbox]').checked;\n                    console.log(stat);\n                    kwToken.actor.setFlag('kw-warfare', 'advantage.'+stat, advantage ? 1 : 0);\n                }\n            }\n        },\n        default: \"setAdvantage\"    \n    }).render(true)\n\n})();","folder":null,"sort":0,"permission":{"default":0},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.UipeovNFJOAJhcK5"}},"_id":"9nw6plga02FApMbt"}
